## 接口文档




实时在线文档网址：https://www.showdoc.com.cn/1882878721074715/8710731786498363


note:前后端的post接口无法正常接受列表，所以要一字符串的形式拼接，用","隔开



一些前端约定：



*   布尔值全部传0、1
*   如果不是必填的选项可以传空也可以不传
*   如果发生用户权限错误会返回401，其他错误为4XX
*   如果发生错误，返回的json中的data段中会有提示信息，可以弹窗显示，至少应该在控制台打印出来
*   注意如果容器被重启或者重开，图片会全部消失，但是可以通过向：<后端地址>/pictures/init 发送请求后加载出来
*   默认数据库中有六个用户其中管理员：`{"username":"admin","id":1,"identity":2}`
*   禁止将未公开的图片添加到展览中




#### 主页展示



> GET  index



参数



| 名称       | 类型 | 是否必填 | 限制       | 描述                 |
| ---------- | ---- | -------- | ---------- | -------------------- |
| picNum     | int  | 否       | default=10 | 需要获取的图片的数目 |
| exhibitNum | int  | 否       | default=10 | 需要获取的展览的数目 |



返回



| 状态码 | 数据                               | 解释 |
| ------ | ---------------------------------- | ---- |
| 400    | 无                                 | 失败 |
| 200    | {'exhibits':exhibits, 'pics':pics} | 成功 |



exhibits是`list<dic>`,列表中的每一个字典对应着一个展览，该字典中的键值对如下



| 名称     | 类型           | 描述                                |
| -------- | -------------- | ----------------------------------- |
| id       | `int`          | id                                  |
| title    | `string`       | 标题                                |
| intro    | `string`       | 简介                                |
| tags     | `list<string>` | 标签                                |
| style    | `list<int>`    | 样式                                |
| time     | `int`          | 时间                                |
| likesNum | `int`          | 点赞数                              |
| pic      | `stirng`       | 图片url（默认为展览中的第一张图片） |



pics是字典的列表：



| 名称     | 类型   | 描述                    |
| -------- | ------ | ----------------------- |
| id       | int    | 图片的id                |
| title    | string | 标题                    |
| intro    | string | 简介                    |
| tags     | list   | 标签                    |
| likesNum | int    | 点赞数                  |
| pic      | url    | 图片文件:放修复后的图片 |
| time     | int    | 原图创建时间            |




### 1.  图片类


#### 1.1  上传图片



> POST  pictures_upload


注意：


1. 可能需要自己写form表单，如果el-upload能够携带其他的参数信息也可以，而且当有多张图片需要上传的时候需要一张一张的发
2. 注意该方式添加的图片默认都是非公开的


参数



| 名称           | 类型     | 是否必填 | 限制 | 描述                                                         |
| -------------- | -------- | -------- | ---- | ------------------------------------------------------------ |
| FILE           | image    | 是       |      | 图片文件                                                     |
| exhibit_id     | `int`    | 否       |      | 如果有则是绑定展览                                           |
| repair_options | `string` | 否       |      | 用"，"隔开的修复操作，可以发修复操作的序列号也可以发修复操作的名称 |
| title          | `string` | 否       |      | 标题，默认为文件名                                           |
| intro          | `string` | 否       |      | 简介                                                         |
| public         | `int`    | 否       |      | 0->非公开 1->公开                                            |
| tags           | `stirng` | 否       |      | 用","分割开的tags                                            |



返回



| 状态码 | 数据          | 解释                     |
| ------ | ------------- | ------------------------ |
| 40X    | 无            | 上传失败                 |
| 200    | {"id": `int`} | 上传成功,返回picture的id |




#### 1.2  搜索图片



> GET pictures_search



参数



note：顺序定义----点赞数大的和时间最近的靠前，逆序相反；   不传参数时默认是时间越早越靠前



| 名称          | 类型              | 是否必填 | 限制 | 描述                                                         |
| ------------- | ----------------- | -------- | ---- | ------------------------------------------------------------ |
| public        | `int`             | 是       |      | 图片是否公开：0-未公开，1-已公开，2-所有                     |
| repair_status | `int`             | 是       |      | 图片的修复状态：0-未修复，1-修复中，2-所有                   |
| exhibit_id    | `int`             | 否       |      | 从该展览中查找图片                                           |
| tags          | `list<stirng>`    | 否       |      | 图片的标签列表，可以有多个                                   |
| is_mine       | `int`             | 否       |      | 图片是否由自己创建，0：否 1：是，默认为0                     |
| is_delete     | `int`             | 否       |      | 搜索的图片是否被删除，0：未删除 1：已删除 默认为0            |
| title         | `string`          | 否       |      | 图片标题的筛选字段（采用字符串匹配的方式）                   |
| time          | `list<timestamp>` | 否       |      | list[0]开始时间，list[1]为终止时间，默认按照时间最近排最前的方式返回列表 |
| order_type    | `int`             | 否       |      | 0：点赞数 1：时间                                            |
| order         | `int`             | 否       |      | 0：逆序 1：顺序                                              |
| search_range  | `list<int>`       | 否       |      | 不填全传，填了的话是左开右闭的区间                           |



返回



| 状态码 | 数据类型                                 | 解释 |
| ------ | ---------------------------------------- | ---- |
| 400    | 无                                       | 失败 |
| 200    | `{"pictures":list<dic>,"numbers":<int>}` | 成功 |



"pictures"键对应的值是一个字典的列表，列表中的每一个元素（都是一个字典，键值对信息见下表）存储着一张图片的信息



| 名称           | 类型             | 描述                                                         |
| -------------- | ---------------- | ------------------------------------------------------------ |
| id             | `int`            | 图片的id                                                     |
| title          | `string`         | 标题                                                         |
| intro          | `string`         | 简介                                                         |
| tags           | `list`           | 标签                                                         |
| likesNum       | `int`            | 点赞数                                                       |
| like           | `int`            | 访问的用户是否点过赞：0-未点赞  1-点赞                       |
| collectionNum  | `int`            | 收藏数                                                       |
| collection     | `int`            | 访问的用户是否收藏过：0：未收藏 1：已收藏                    |
| time           | `int(timestamp)` | 图片的上传时间                                               |
| pic            | `string`         | 图片的`url`                                                  |
| repair_numbers | `int`            | 当前已经可以看的图片的数目（包括上传的图片和修复步骤中已经修复好的图片） |
| all_numbers    | `int`            | 返回搜索结果总数                                             |


`numbers`键对应的值是一个整数，表示搜索条件下的结果总数


但 `pictures`键对应的值只有search_range区间对应的数目


#### 1.3  删除图片



> POST  pictures_delete


note:这种改动可以兼容之前的版本和之后的版本，也即之前的前端代码也能正常删除


参数



| 名称        | 类型     | 是否必填 | 限制 | 描述                                             |
| ----------- | -------- | -------- | ---- | ------------------------------------------------ |
| id          | `string` | 是       |      | 图片的id列表                                     |
| delete_type | `int`    | 否       |      | 删除方式 0:暂时删除（可恢复） 1:永久删除 默认为0 |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 40X    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 1.4  恢复被删除的图片



> POST pictures_release



参数



| 名称 | 类型     | 是否必填 | 限制 | 描述                  |
| ---- | -------- | -------- | ---- | --------------------- |
| id   | `string` | 是       |      | 待恢复的图片的id_list |



返回



| 状态码 | 数据                              | 解释 |
| ------ | --------------------------------- | ---- |
| 400    | 无                                | 失败 |
| 200    | `list<int>`(未操作成功的图片的id) | 成功 |




#### 1.5  添加图片修复操作序列



> POST  picture_repair



参数



| 名称           | 类型 | 是否必填 | 限制 | 描述                                 |
| -------------- | ---- | -------- | ---- | ------------------------------------ |
| id             | int  | 是       |      | 待修复的图片的id                     |
| repair_options | list | 是       |      | 修复操作的名字用string的列表传递即可 |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 400    | 无   | 失败 |
| 200    | 无   | 成功 |



即使前端一次上传多个操作，我们会将每个操作作为一次修复步骤存储



前端上传后应当向后端重新请求当前页面的数据




#### 1.6  删除最后一个修复step



> POST  reapirstep_delete



参数



| 名称 | 类型 | 是否必填 | 限制 | 描述     |
| ---- | ---- | -------- | ---- | -------- |
| id   | int  | 是       |      | 图片的id |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 400    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 1.7  查询单张图片全部信息



> GET  picture_search



参数



| 名称     | 类型 | 是否必填 | 限制 | 描述                                |
| -------- | ---- | -------- | ---- | ----------------------------------- |
| id       | int  | 是       |      | 图片的id                            |
| comments | int  | 是       |      | 1：需要返回comments     0：无需返回 |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 40X    | 无   | 失败 |
| 200    | `{}` | 成功 |



字典中的键值对如下：



| 名称           | 类型           | 描述                                                         |
| -------------- | -------------- | ------------------------------------------------------------ |
| id             | `int`          | 图片的id                                                     |
| title          | `string`       | 标题                                                         |
| intro          | `string`       | 简介                                                         |
| tags           | `list`         | 标签                                                         |
| likesNum       | `int`          | 点赞数                                                       |
| pic            | `list<string>` | 图片文件:包括原图和每一步修复的图片（按顺序）（游客只能拿到最后一张图） |
| comments       | `list<dic>`    | [{"body":评论内容, "time":评论时间,"username":用户名,"comment_id":评论的id , "avatar":用户头像}，...] |
| time           | `int`          | 原图上传时间                                                 |
| repair_detail  | `list<string>` | 每一步修复的名称（按顺序）,第一个元素是“原图”(游客不发这个字段) |
| like           | `bool`         | 当前用户是否对该图片点过赞                                   |
| public         | `int`          | 0：未公开   1：已公开                                        |
| repair_status  | `int`          | 0：未修复   1：已有过修复操作                                |
| repair_numbers | `int`          | 含原图在内可以加载出来的图片数目（总数可以通过获取repair_detail列表的长度获取） |




#### 1.8  修改单张图片信息



前端根据状态码直接修改界面信息



> POST picture_modify



参数



| 名称   | 类型   | 是否必填 | 描述                                    |
| ------ | ------ | -------- | --------------------------------------- |
| id     | int    | 是       | 图片的id                                |
| public | int    | 否       | 0：不公开 1：公开，不传或传空则保持不变 |
| title  | string | 否       | 标题                                    |
| intro  | string | 否       | 简介                                    |
| tags   | list   | 否       | 标签                                    |



返回



| 状态码 | 消息    | 数据 | 解释 |
| ------ | ------- | ---- | ---- |
| 400    | "error" | 无   | 失败 |
| 200    | "ok"    | 无   | 成功 |




### 2.  展览类


#### 2.1  创建展览（不支持添加的图片）



> POST  exhibit_add



参数



| 名称  | 类型           | 是否必填 | 限制 | 描述                  |
| ----- | -------------- | -------- | ---- | --------------------- |
| title | `string`       | 是       |      | 展览标题              |
| intro | `string`       | 否       |      |                       |
| style | `int`          | 否       |      | 样式列表，用" , "拼接 |
| tags  | `list<string>` | 否       |      |                       |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 400    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 2.2  删除该展览



> POST exhibits_delete



参数



| 名称        | 类型     | 是否必填 | 限制 | 描述                                              |
| ----------- | -------- | -------- | ---- | ------------------------------------------------- |
| id          | `string` | 是       |      | 待删除的展览的id_list                             |
| delete_type | `int`    | 否       |      | 删除方式 0:暂时删除（可恢复） 1:永久删除  默认为0 |



返回



| 状态码 | 数据                              | 解释 |
| ------ | --------------------------------- | ---- |
| 400    | 无                                | 失败 |
| 200    | `list<int>`(未删除成功的展览的id) | 成功 |




#### 2.3  搜索展览



> GET exhibits_search



参数



| 名称         | 类型           | 是否必填 | 限制 | 描述                                              |
| ------------ | -------------- | -------- | ---- | ------------------------------------------------- |
| public       | `int`          | 是       |      | 展览所属状态：0：未公开，1：已公开，2：全部       |
| title        | `string`       | 否       |      | 字符串匹配项                                      |
| tags         | `list<string>` | 否       |      | 标签序列                                          |
| is_mine      | `int`          | 否       |      | 展览是否由自己创建，0：否 1：是，默认为0          |
| is_delete    | `int`          | 否       |      | 搜索的图片是否被删除，0：未删除 1：已删除 默认为0 |
| time         | `list<int>`    | 否       |      | `[起始时间(int), 终止时间(int)]`                  |
| order_type   | `int`          | 否       |      | 0：点赞数 1：时间                                 |
| order        | `int`          | 否       |      | 0：逆序 1：顺序                                   |
| search_range | `list<int>`    | 否       |      | 不填全传，填了的话是左开右闭的区间                |



对type做说：如果是管理员type确实有0、1、2之分，如果是用户则只能传入type=1，如果不是1



的话后端会返回权限错误



返回



| 状态码 | 数据                                     | 解释 |
| ------ | ---------------------------------------- | ---- |
| 400    | 无                                       | 失败 |
| 200    | `{"exhibits":list<dic>,"numbers":<int>}` | 成功 |



"exhibits"键对应的值是一个字典的列表，列表中的每一个元素（都是一个字典，键值对信息见下表）存储着一个展览的信息



| 名称  | 类型          | 描述                               |
| ----- | ------------- | ---------------------------------- |
| id    | `int`         | 展览id                             |
| title | `string`      | 标题                               |
| intro | `string`      | 简介                               |
| style | `list<int>`   | 样式列表                           |
| time  | `int`         | 创建时间                           |
| pic   | `string(src)` | 展览的封面图片（默认为第一张图片） |
| like  | `bool`        | 发送请求的用户是否点过赞           |
| tags  | `list`        | 标签列表                           |



"numbers"键对应的值是一个整数，表示搜索条件下的结果总数




#### 2.4  修改展览



直接替换参数



> POST  exhibit_modify



参数



| 名称            | 类型   | 是否必填 | 描述                                                       |
| --------------- | ------ | -------- | ---------------------------------------------------------- |
| id              | int    | 是       | 展览id                                                     |
| title           | string | 否       | 标题                                                       |
| intro           | string | 否       | 简介                                                       |
| style           | string | 否       | 用" , "隔开的展览样式数组                                  |
| public          | int    | 否       | 展览所属状态：0：未公开，1：已公开，空或者不传意味着不更改 |
| full_pictures   | list   | 否       | 要添加的所有图片的id的list                                 |
| add_pictures    | list   | 否       | 追加的图片                                                 |
| delete_pictures | list   | 否       |                                                            |



 返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 400    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 2.5  查询单个展览的所有信息



> GET exhibit_search



参数



| 名称     | 类型  | 是否必填 | 限制 | 描述                   |
| -------- | ----- | -------- | ---- | ---------------------- |
| id       | `int` | 是       |      | 展览的id               |
| comments | `int` | 是       |      | 0：不传评论；1：传评论 |



返回



| 状态码 | 数据  | 解释 |
| ------ | ----- | ---- |
| 400    | 无    | 失败 |
| 200    | `dic` | 成功 |



字典中的键值对是：



| 名称          | 类型        | 描述                                       |
| ------------- | ----------- | ------------------------------------------ |
| id            | `int`       | 展览的id                                   |
| title         | `string`    | 标题                                       |
| intro         | `string`    | 简介                                       |
| tags          | `list`      | 标签                                       |
| likesNum      | `int`       | 点赞数                                     |
| collectionNum | `int`       | 收藏数                                     |
| like          | `int`       | 用户是否对该展览点过赞   0-未点赞   1-点赞 |
| collection    | `int`       | 用户是否对该展览收藏过   0-未收藏   1-收藏 |
| public        | `int`       | 是否公开                                   |
| comments      | `list<dic>` | **如果comments为0则没有此字段**            |


comments：`list<dic>`中的`dic`中字段如下


| 名称       | 类型     | 描述     |
| ---------- | -------- | -------- |
| body       | `string` | 评论内容 |
| time       | `int`    | 评论时间 |
| comment_id | `int`    | 评论的id |
| username   | `string` | 用户名   |
| avatar     | `string` | 头像路径 |
| user_id    | `int`    | 用户id   |




#### 2.6  恢复被删除的展览



> POST exhibits_release



参数



| 名称 | 类型     | 是否必填 | 限制 | 描述                  |
| ---- | -------- | -------- | ---- | --------------------- |
| id   | `string` | 是       |      | 待恢复的展览的id_list |



返回



| 状态码 | 数据                              | 解释 |
| ------ | --------------------------------- | ---- |
| 400    | 无                                | 失败 |
| 200    | `list<int>`(未操作成功的展览的id) | 成功 |






### 3.  用户类


#### 3.1  用户查找



> GET users_search



参数



| 名称         | 类型        | 是否必填 | 限制 | 描述                                                         |
| ------------ | ----------- | -------- | ---- | ------------------------------------------------------------ |
| type         | `int`       | 是       |      | 0：未审核 1：已注册  -1：封禁 -2：不良用户 -3：存疑用户      |
| order_type   | `int`       | 否       |      | 具体取值与type有关，下面会给出表格，不填会按照默认排序方式给出，不填的话默认值是0 |
| text         | `string`    | 否       |      | 查找内容（要求查找出的用户名中应该含有该字段）               |
| order        | `int`       | 否       |      | 顺序/逆序                                                    |
| search_range | `list<int>` | 否       |      | 查询的区间（不填全传）                                       |


| order_type\type | 0(未审核)    | 1              | -1       | -2                                                           | -3             |
| --------------- | ------------ | -------------- | -------- | ------------------------------------------------------------ | -------------- |
| 0               | 注册时间     | 注册时间       | 封禁时间 | 用户最新不良评论的时间                                       | 存疑评论的时间 |
| 1               | ------------ | 最新的登陆时间 | 解封时间 | 用户的不良评论数量（数目相同时按照存疑评论较多的靠前的返回） | 存疑评论的数量 |




返回



| 状态码 | 数据                                   | 解释 |
| ------ | -------------------------------------- | ---- |
| 40X    | 无                                     | 失败 |
| 200    | `{"users": list<dic>, "numbers": int}` | 成功 |



列表中每一项对应的一个用户的信息字典，字典中的键值对为：



| 名称     | 类型     | 描述     |
| -------- | -------- | -------- |
| username | `string` | 用户名   |
| id       | `int`    | 用户id   |
| avatar   | `string` | 头像     |
| identity | `int`    | 身份信息 |




#### 3.2  删除用户



> POST  user_delete



参数



| 名称 | 类型     | 是否必填 | 限制 | 描述       |
| ---- | -------- | -------- | ---- | ---------- |
| id   | `string` | 是       |      | 用户id列表 |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 400    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 3.3  封禁与解封



> POST user_state_modify


**新增功能：设置封禁时间，到期自动解封**



参数



| 名称 | 类型     | 是否必填 | 限制 | 描述                                       |
| ---- | -------- | -------- | ---- | ------------------------------------------ |
| id   | `string` | 是       |      | 待操作的用户的id列表                       |
| type | `int`    | 是       |      | 0：封禁（永久）；1：解封 2：封禁一定的时间 |
| time | `int`    | 否       |      | 如果type=2，则传递封禁至的具体时间         |



返回



| 状态码 | 数据           | 解释 |
| ------ | -------------- | ---- |
| 400    | 无             | 失败 |
| 200    | `list<string>` | 成功 |


返回的`list<string>`是操作不成功的用户名列表






#### 3.4  审批注册用户



> POST  user_exam



参数



| 名称 | 类型     | 是否必填 | 限制 | 描述                 |
| ---- | -------- | -------- | ---- | -------------------- |
| id   | `string` | 是       |      | 待审批的用户的id列表 |



返回



| 状态码 | 数据           | 解释 |
| ------ | -------------- | ---- |
| 400    | 无             | 失败 |
| 200    | `list<string>` | 成功 |




#### 3.5  登录



> POST login



参数



| 名称     | 类型   | 是否必填 | 限制 | 描述                        |
| -------- | ------ | -------- | ---- | --------------------------- |
| username | string | 是       |      |                             |
| password | string | 是       |      |                             |
| remember | int    | 是       |      | 1：存cookie   2：不存cookie |



返回



| 状态码 | 数据                                       | 解释 |
| ------ | ------------------------------------------ | ---- |
| 400    | 无                                         | 失败 |
| 200    | {"username": "..." , "identity":(int)... } | 成功 |




#### 3.6  注销



> POST log_out



参数:无需携带任何参数



| 名称 | 类型 | 是否必填 | 限制 | 描述 |
| ---- | ---- | -------- | ---- | ---- |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 400    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 3.7  注册



> POST register



参数



| 名称      | 类型   | 是否必填 | 限制 | 描述                           |
| --------- | ------ | -------- | ---- | ------------------------------ |
| username  | string | 是       |      |                                |
| password  | string | 是       |      |                                |
| indentity | int    | 是       |      | 1：申请普通用户  2：申请管理员 |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 400    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 3.8  验证信息



> POST verify



参数：无



返回



| 状态码 | 数据         | 解释                       |
| ------ | ------------ | -------------------------- |
| 40X    | 无           | 失败，返回错误信息前端展示 |
| 200    | `dictionary` | 成功                       |


note:


1. 当用户被封禁的时候会手动帮用户清除后端存储的cookie
2. 用户未登录的时候也会返回成功但是identity=0，其他字段为空
2. 用户被封禁的时候后端会自动将其注销


成功的时候返回的字典内的字段如下 


| 名称     | 类型     | 描述           |
| -------- | -------- | -------------- |
| id       | `int`    | 用户的id       |
| username | `string` | 用户名         |
| identity | `int`    | 用户身份的信息 |
| avatar   | `string` | 头像url        |




#### 3.9 查找用户的所有不良记录



> GET search_user_bad_comment


参数：


| 名称 | 类型  | 描述     |
| ---- | ----- | -------- |
| id   | `int` | 用户的id |



返回



| 状态码 | 数据                                                         | 解释                       |
| ------ | ------------------------------------------------------------ | -------------------------- |
| 40X    | 无                                                           | 失败，返回错误信息前端展示 |
| 200    | `{"bad_users":list<dictionary>,"doubt_users":list<dictionary>}` | 成功                       |


成功的时候返回的列表中的每一个字典内的字段如下 


| 名称                  | 类型     | 描述                                |
| --------------------- | -------- | ----------------------------------- |
| body                  | `string` | 评论内容                            |
| comment_id            | `int`    | 评论的id（删除/恢复的时候需要用到） |
| time                  | `int`    | 评论时间                            |
| detection_type        | `int`    | 评论的属性：1->合格 2->不良 3->存疑 |
| username              | `string` | 评论的用户的用户名                  |
| avatar                | `string` | 用户头像url                         |
| user_id               | `int`    | 用户的id（封禁用户可以使用）        |
| title                 | `stirng` | 标题                                |
| type                  | `int`    | 评论对象的类型，1->展览 2->图片     |
| exhibit_id/picture_id | `int`    | 展览/图片的id                       |




#### 3.10 编辑用户信息



> POST modify_user_info


参数：


| 名称         | 类型     | 限制 | 描述   |
| ------------ | -------- | ---- | ------ |
| username     | `string` | 否   | 用户名 |
| old_password | `string` | 否   | 旧密码 |
| new_password | `string` | 否   | 新密码 |



返回



| 状态码 | 数据 | 解释                       |
| ------ | ---- | -------------------------- |
| 40X    | 无   | 失败，返回错误信息前端展示 |
| 200    | 无   | 成功                       |


成功的时候返回的列表中的每一个字典内的字段如下 




### 4.  操作


#### 4.1  点赞图片/展览



> POST like



参数



| 名称 | 类型 | 是否必填 | 限制 | 描述                |
| ---- | ---- | -------- | ---- | ------------------- |
| id   | int  | 是       |      | 操作对象的id        |
| like | int  | 是       |      | 1：点赞 0：取消点赞 |
| type | int  | 是       |      | 1：展览  2：图片    |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 400    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 4.2  评论图片/展览



> POST comment



参数



| 名称    | 类型   | 是否必填 | 限制 | 描述             |
| ------- | ------ | -------- | ---- | ---------------- |
| id      | int    | 是       |      | 操作对象的id     |
| comment | string | 是       |      | 评论内容         |
| type    | int    | 是       |      | 1：展览  2：图片 |



返回



| 状态码 | 数据                                  | 解释 |
| ------ | ------------------------------------- | ---- |
| 40X    | `{"type": <int>, "message":<string>}` | 失败 |
| 200    | 无                                    | 成功 |


报错有以下情况：


1. type = 2：评论违规，具体违规信息在message中
1. type = 3：评论疑似违规，message为空
1. type = 4：评论审核失败




#### 4.3  收藏图片/展览



> POST collection



参数



| 名称   | 类型  | 是否必填 | 限制 | 描述                  |
| ------ | ----- | -------- | ---- | --------------------- |
| id     | `int` | 是       |      | 待收藏对象的id        |
| option | `int` | 是       |      | 0：取消收藏   1：收藏 |
| type   | `int` | 是       |      | 1：展览  2：图片      |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 40X    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 4.4  删除评论



> POST delete_comments



| 名称 | 类型     | 是否必填 | 限制 | 描述                     |
| ---- | -------- | -------- | ---- | ------------------------ |
| id   | `string` | 是       |      | 评论的id_list,用”，“隔开 |
| type | `int`    | 是       |      | 1：展览  2：图片         |




#### 4.5  封禁评论



> POST freeze_comments



| 名称 | 类型     | 是否必填 | 限制 | 描述                     |
| ---- | -------- | -------- | ---- | ------------------------ |
| id   | `string` | 是       |      | 评论的id_list,用”，“隔开 |
| type | `int`    | 是       |      | 1：展览  2：图片         |


返回



| 状态码 | 数据        | 解释 |
| ------ | ----------- | ---- |
| 40X    | 无          | 失败 |
| 200    | `list<int>` | 成功 |


返回未操作成功的评论的id列表




#### 4.6 解封评论



> POST release_comments



参数



| 名称 | 类型     | 是否必填 | 限制 | 描述                              |
| ---- | -------- | -------- | ---- | --------------------------------- |
| type | `int`    | 是       |      | 评论的对象的类型，1：展览 2：图片 |
| id   | `string` | 是       |      | 删除的历史id列表用","拼接         |



返回



| 状态码 | 数据        | 解释 |
| ------ | ----------- | ---- |
| 40X    | 无          | 失败 |
| 200    | `list<int>` | 成功 |


返回未操作成功的评论的id列表




#### 4.7 解封用户的所有评论



> POST release_users



参数



| 名称 | 类型     | 是否必填 | 限制 | 描述                  |
| ---- | -------- | -------- | ---- | --------------------- |
| id   | `string` | 是       |      | 待解封的用户的id_list |



返回



| 状态码 | 数据        | 解释 |
| ------ | ----------- | ---- |
| 40X    | 无          | 失败 |
| 200    | `list<int>` | 成功 |


返回未操作成功的用户的id列表




#### 4.8  查询用户全部的点赞图片/展览



> GET user_likes



参数



| 名称         | 类型        | 是否必填 | 限制 | 描述                       |
| ------------ | ----------- | -------- | ---- | -------------------------- |
| type         | `int`       | 是       |      | 1：展览 2：图片            |
| order        | `int`       | 否       |      | 0：按时间逆序 1:按时间顺序 |
| search_range | `list<int>` | 否       |      | 搜索的范围，不填全传递     |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 40X    | 无   | 失败 |
| 200    | `{}` | 成功 |



字典中的键值对如下：



若`type = 2`，字典为`{'pictures':list<dic>,'numbers':int}` numbers为查找到图片的总数 其中`pictures`的列表中每一项的键值对如下



| 名称     | 类型   | 描述     |
| -------- | ------ | -------- |
| id       |        | 图片的id |
| title    | string | 标题     |
| intro    | string | 简介     |
| tags     | list   | 标签     |
| likesNum | int    | 点赞数   |
| pic      | 文件   | 图片文件 |
| like     | int    | 是否点赞 |



若`type = 1`，字典为`{'exhibits':list<dic>,'numbers':int}` numbers为查找到展览的总数 其中`exhibits`的列表中每一项的键值对如下



| 名称  | 类型          | 描述                               |
| ----- | ------------- | ---------------------------------- |
| id    | `int`         | 展览id                             |
| title | `string`      | 标题                               |
| intro | `string`      | 简介                               |
| style | `list<int>`   | 样式列表                           |
| time  | `int`         | 创建时间                           |
| pic   | `string(src)` | 展览的封面图片（默认为第一张图片） |
| like  | `bool`        | 发送请求的用户是否点过赞           |
| tags  | `list`        | 标签列表                           |
| like  | int           | 是否点赞                           |




#### 4.8  查询用户全部的评论图片/展览



> GET user_comment


参数



| 名称         | 类型        | 是否必填 | 限制 | 描述                       |
| ------------ | ----------- | -------- | ---- | -------------------------- |
| type         | int         | 是       |      | 1：展览 2：图片            |
| order        | `int`       | 否       |      | 0：按时间逆序 1:按时间顺序 |
| search_range | `list<int>` | 否       |      | 搜索的范围，不填全传递     |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 40X    | 无   | 失败 |
| 200    | `{}` | 成功 |



字典中的键值对如下：



字典为`{'pictures/exhibits':list<dic>,'numbers':int}` numbers为查找到评论的总数 comment里或是该用户的所有评论中针对**图片**的评论，或是该用户的所有评论中针对**展览**的评论



| 名称  | 类型     | 描述                     |
| ----- | -------- | ------------------------ |
| body  | `string` | 评论内容                 |
| time  | `int`    | 创建时间                 |
| title | `string` | 所评论的图片或展览的名称 |
| id    | `string` | 所评论的图片或展览的id   |




#### 4.9  查询用户全部的收藏图片/展览



> GET user_collection


参数


| 名称         | 类型        | 是否必填 | 限制 | 描述                       |
| ------------ | ----------- | -------- | ---- | -------------------------- |
| type         | int         | 是       |      | 1：展览 2：图片            |
| order        | `int`       | 否       |      | 0：按时间逆序 1:按时间顺序 |
| search_range | `list<int>` | 否       |      | 搜索的范围，不填全传递     |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 40X    | 无   | 失败 |
| 200    | `{}` | 成功 |



字典中的键值对如下：



若`type = 2`，字典为`{'pictures':list<dic>,'numbers':int}` numbers为查找到图片的总数 其中`pictures`的列表中每一项的键值对如下



| 名称     | 类型           | 描述     |
| -------- | -------------- | -------- |
| id       | `int`          | 图片的id |
| title    | `string`       | 标题     |
| intro    | `string`       | 简介     |
| tags     | `list<string>` | 标签     |
| likesNum | `int`          | 点赞数   |
| pic      | `string`       | 图片url  |
| like     | `int`          | 是否点赞 |



若`type = 1`，字典为`{'exhibits':list<dic>,'numbers':int}` numbers为查找到展览的总数 其中`exhibits`的列表中每一项的键值对如下



| 名称  | 类型          | 描述                               |
| ----- | ------------- | ---------------------------------- |
| id    | `int`         | 展览id                             |
| title | `string`      | 标题                               |
| intro | `string`      | 简介                               |
| style | `list<int>`   | 样式列表                           |
| time  | `int`         | 创建时间                           |
| pic   | `string(src)` | 展览的封面图片（默认为第一张图片） |
| like  | `bool`        | 发送请求的用户是否点过赞           |
| tags  | `list`        | 标签列表                           |
| like  | int           | 是否点赞                           |




#### 4.10  查询用户全部的浏览历史



> GET user_history


参数



| 名称         | 类型        | 是否必填 | 限制 | 描述                       |
| ------------ | ----------- | -------- | ---- | -------------------------- |
| type         | int         | 是       |      | 1：展览 2：图片            |
| order        | `int`       | 否       |      | 0：按时间逆序 1:按时间顺序 |
| search_range | `list<int>` | 否       |      | 搜索的范围，不填全传递     |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 40X    | 无   | 失败 |
| 200    | `{}` | 成功 |



字典中的键值对如下：



若`type = 2`，字典为`{'pictures':list<dic>,'numbers':int}` numbers为查找到图片的总数 其中`pictures`的列表中每一项的键值对如下



| 名称         | 类型           | 描述     |
| ------------ | -------------- | -------- |
| id           | `int`          | 图片的id |
| title        | `string`       | 标题     |
| intro        | `string`       | 简介     |
| tags         | `list<string>` | 标签     |
| likesNum     | `int`          | 点赞数   |
| pic          | `string`       | 图片url  |
| like         | `int`          | 是否点赞 |
| history_time | `int`          | 浏览时间 |



若`type = 1`，字典为`{'exhibits':list<dic>,'numbers':int}` numbers为查找到展览的总数 其中`exhibits`的列表中每一项的键值对如下



| 名称         | 类型        | 描述                               |
| ------------ | ----------- | ---------------------------------- |
| id           | `int`       | 展览id                             |
| title        | `string`    | 标题                               |
| intro        | `string`    | 简介                               |
| style        | `list<int>` | 样式列表                           |
| time         | `int`       | 创建时间                           |
| pic          | `string`    | 展览的封面图片（默认为第一张图片） |
| tags         | `list`      | 标签列表                           |
| like         | int         | 是否点赞                           |
| likesNum     | `int`       | 点赞数                             |
| history_time | `int`       | 浏览时间                           |




#### 4.11  删除用户的浏览历史



> POST delete_view_history



参数



| 名称 | 类型     | 是否必填 | 限制 | 描述                      |
| ---- | -------- | -------- | ---- | ------------------------- |
| type | `int`    | 是       |      | 1：展览 2：图片           |
| id   | `string` | 是       |      | 删除的历史id列表用","拼接 |



返回



| 状态码 | 数据 | 解释 |
| ------ | ---- | ---- |
| 40X    | 无   | 失败 |
| 200    | 无   | 成功 |




#### 4.12 查询用户的搜索历史



> POST search_history



参数



| 名称 | 类型  | 是否必填 | 限制 | 描述            |
| ---- | ----- | -------- | ---- | --------------- |
| type | `int` | 是       |      | 1：展览 2：图片 |



返回



| 状态码 | 数据         | 解释 |
| ------ | ------------ | ---- |
| 40X    | 无           | 失败 |
| 200    | `list<text>` | 成功 |





#### 4.13 删除用户的搜索历史



> POST delete_search_history



参数



| 名称      | 类型     | 是否必填 | 限制 | 描述                        |
| --------- | -------- | -------- | ---- | --------------------------- |
| type      | `int`    | 是       |      | 1：展览 2：图片             |
| text_list | `string` | 是       |      | 删除的历史文本列表用","拼接 |



返回



| 状态码 | 数据         | 解释 |
| ------ | ------------ | ---- |
| 40X    | 无           | 失败 |
| 200    | `list<text>` | 成功 |







### 5.  标签类




#### 5.1  添加标签



> POST  add_tags 



参数



| 名称 | 类型   | 是否必填 | 限制 | 描述                         |
| ---- | ------ | -------- | ---- | ---------------------------- |
| tags | string | 是       |      | 用逗号分割的所有待添加的标签 |


返回



| 状态码 | 数据             | 解释                       |
| ------ | ---------------- | -------------------------- |
| 40X    | `string`         | 错误信息，希望前端弹窗提示 |
| 200    | [`string`, ... ] | 返回重复的标签列表         |


注意如果用户添加的标签里面有重复或者和已有标签重复的选项仍然能够添加成功，不过会返回一个列表，里面填充的是重复的标签的名称，可以以提示框的方式提示管理员，正常的话返回空列表




#### 5.2  删除标签



> POST  delete_tags 


管理员才能操作



| 名称 | 类型     | 描述                |
| ---- | -------- | ------------------- |
| tags | `stirng` | 多个标签名用","分割 |



返回



| 状态码 | 数据           | 描述                       |
| ------ | -------------- | -------------------------- |
| 40X    | string`        | 错误信息，希望前端弹窗提示 |
| 200    | `list<string>` | 返回不存在的标签列表       |


解释：如果传入后端的标签列表中有后台不存在的，那么就会将其存入列表中并进行返回，希望前端通过某种方式将这些tag以弹窗的方式展示出来提示这些标签不存在而其他的已经删除




#### 5.3  查询标签



> GET  search_tags 


除了被封禁的用户之外均可访问



返回



| 状态码 | 数据           | 描述                       |
| ------ | -------------- | -------------------------- |
| 40X    | string         | 错误信息，希望前端弹窗提示 |
| 200    | `list<string>` | 返回所有的标签构成的列表   |






TODO：


封禁时间


其他修复操作，修复接口的重写


如果一个展览被删掉了那么这些恶意评论会怎么样


将search_bad_user 接口以增加参数的方式合并到user_search接口中